<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SolSniperBot - Automatisierte Meme-Coin Snipes</title>
    <script src="https://cdn.jsdelivr.net/npm/@solana/web3.js@1.73.0/lib/index.iife.js"></script>
</head>
<body>
    <h1>SolSniperBot - Verbinde deine Phantom Wallet</h1>
    <button id="connectButton">Phantom Wallet verbinden</button>
    <p id="walletAddress"></p>
    <p id="status"></p>

    <h2>Manueller Token Swap</h2>
    <input type="text" id="inputToken" placeholder="Input Token (SOL)" />
    <input type="text" id="outputToken" placeholder="Output Token (z.B. MEME)" />
    <input type="number" id="amount" placeholder="Betrag in SOL" />
    <button id="swapButton">Token tauschen</button>

    <h2>Automatisierter Meme-Coin Sniper</h2>
    <button id="snipeButton">Automatisch neue Meme-Coins kaufen</button>

    <script>
        const connectButton = document.getElementById('connectButton');
        const swapButton = document.getElementById('swapButton');
        const snipeButton = document.getElementById('snipeButton');
        const walletAddressElement = document.getElementById('walletAddress');
        const statusElement = document.getElementById('status');
        
        let wallet;

        // Prüfen, ob Phantom Wallet vorhanden ist
        const isPhantomInstalled = window.solana && window.solana.isPhantom;
        if (!isPhantomInstalled) {
            statusElement.innerText = "Bitte installiere die Phantom Wallet-Erweiterung!";
            connectButton.disabled = true;
            swapButton.disabled = true;
            snipeButton.disabled = true;
        }

        // Verbinden mit Phantom Wallet
        connectButton.onclick = async () => {
            try {
                const resp = await window.solana.connect();
                wallet = window.solana;
                const publicKey = resp.publicKey.toString();
                walletAddressElement.innerText = `Verbunden: ${publicKey}`;
                statusElement.innerText = "Wallet erfolgreich verbunden!";
            } catch (err) {
                console.error(err);
                statusElement.innerText = "Verbindung fehlgeschlagen!";
            }
        };

        // Funktion für den Honeypot-Check
        async function checkIfSellable(tokenMint) {
            try {
                const response = await fetch(`https://api.raydium.io/v2/pairs/${tokenMint}`);
                const poolData = await response.json();

                // Prüfe, ob der Pool eine Mindestliquidität hat (z.B. mehr als 50 SOL)
                if (poolData.liquidity < 50) {
                    console.warn("Warnung: Geringe Liquidität, könnte ein Honeypot sein!");
                    return false;
                }

                console.log("Token scheint sicher handelbar zu sein.");
                return true;
            } catch (err) {
                console.error("Fehler beim Prüfen des Honeypots:", err);
                return false;
            }
        }

        // Raydium Swap-Funktion mit Honeypot-Check
        swapButton.onclick = async () => {
            const inputToken = document.getElementById('inputToken').value;
            const outputToken = document.getElementById('outputToken').value;
            const amount = parseFloat(document.getElementById('amount').value);

            if (!wallet || !inputToken || !outputToken || !amount) {
                statusElement.innerText = "Bitte alle Felder ausfüllen!";
                return;
            }

            // Führe den Honeypot-Check vor dem Swap durch
            const isSellable = await checkIfSellable(outputToken);
            if (!isSellable) {
                statusElement.innerText = "Achtung! Der Token könnte ein Honeypot sein. Swap abgebrochen!";
                return;
            }

            try {
                statusElement.innerText = "Swap wird vorbereitet...";

                // Beispiel-Request an Raydium API
                const quoteUrl = `https://api.raydium.io/v2/quote?inputMint=${inputToken}&outputMint=${outputToken}&amount=${amount}&slippage=1`;
                const response = await fetch(quoteUrl);
                const quote = await response.json();

                if (quote) {
                    statusElement.innerText = "Swap erfolgreich vorbereitet!";
                    console.log("Swap-Quote:", quote);
                } else {
                    statusElement.innerText = "Fehler beim Abrufen der Swap-Quote!";
                }
            } catch (err) {
                console.error(err);
                statusElement.innerText = "Fehler beim Swap!";
            }
        };

        // Automatisierter Meme-Coin Sniper
        snipeButton.onclick = async () => {
            statusElement.innerText = "Suche nach neuen Meme-Coins...";
            try {
                // Überwache die Raydium-Pools auf neue Einträge
                const poolsUrl = "https://api.raydium.io/v2/pairs";
                const response = await fetch(poolsUrl);
                const pools = await response.json();

                // Suche nach neuen Pools mit "MEME" im Token-Namen
                const newMemePools = pools.filter(pool => pool.name.includes("MEME"));
                console.log("Gefundene Meme-Coins:", newMemePools);

                if (newMemePools.length > 0) {
                    statusElement.innerText = `Gefunden: ${newMemePools.length} Meme-Coins! Automatischer Kauf wird vorbereitet...`;
                    
                    // Beispielhafter Kauf des ersten gefundenen Tokens
                    const firstMemeToken = newMemePools[0];
                    document.getElementById('inputToken').value = "SOL"; // Beispiel Input Token
                    document.getElementById('outputToken').value = firstMemeToken.baseMint;
                    document.getElementById('amount').value = 0.1; // Kauf von 0.1 SOL

                    // Automatisch den Swap ausführen
                    swapButton.click();
                } else {
                    statusElement.innerText = "Keine neuen Meme-Coins gefunden.";
                }
            } catch (err) {
                console.error(err);
                statusElement.innerText = "Fehler beim Suchen nach Meme-Coins!";
            }
        };
    </script>
</body>
</html>
